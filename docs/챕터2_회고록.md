
## 챕터 2 회고록

[챕터 2 서버구축] 을 진행하며 학습한 것들을 소개하며 느낀점을 작성해보겠다
- 분석 및 설계
	- 비즈니스 요구사항 분석
	- uml 다이어그램
	- ERD
	- issue, milestone
	- api 명세
- TDD
- 클린 아키텍쳐, 레이어드 아키텍쳐, DDD

### 분석 및 설계
나는 지금까지 개발자로 많은 프로젝트를 거치면서 분석과 설계를 제대로 해본적이 있을까? 아마 이번이 처음인것 같아서 느낀점이 많다.

프로젝트의 첫 번째 단계이며 향후 프로젝트의 성공여부와도 직관되어 있다고 생각된다. 
명확한 요구사항을 정의하며 프로젝트의 범위를 구체화할 수 있고 이는 작업자로 하여금 명확한 목표 또는 마일스톤이 세워진다.
내가 직접 작성해보며 시퀀스 다이어그램, 플로우 차트 등 비즈니스 요구사항을 시각화하여 내 머리속에 스케치를 눈으로 확인할 수 있게되니 비즈니스의 흐름을 한눈에 파악할 수 있었다. 그리고 다른 사람들의 여러 다이어그램을 보는것도 신선했고 의도를 엿볼 수 있어 하나의 소통이 된다고 생각이 들었다. 
또 다른 이점은 동료들과의 커뮤니케이션은 물론이고 클라이언트와의 이해관계도 높인다.
분석 및 설계는 프로젝트의 시작점이자 방향이고, 신뢰라고 생각한다.

### TDD
나는 현업에서 테스트 코드를 짠 경험이 많이 부족하다. 그때그때 필요하면 기능 한두개 테스트를 작성해보는 정도?,, 항해 플러스 본과정 진행 전에 TDD로 개발하기 스터디를 진행했었다. 그때 느낀점은
"굉장히" 흥미롭고 재밌었다.. 말로만 들었지 이게 이렇게 재밌다고?? 
처음 TDD는 저자 '켄트 백'의 테스트 주도개발 책을 보며 책에 나와있는 예시흐름을 그대로 따라했었다.
컴파일에러 ~ 구현 ~ 리팩토링,,
머리속에 있는 코드들을 테스트 코드로 작성하고, 그 테스트들을 통과하는 코드를 구현하며 로직이 완성된다니! 정말 짜릿한 경험이였다. 빨간줄의 코드들이 녹색으로 채워진다니

그러다보니 어리석게도. TDD가 정답인 줄 알았다. TDD도 있고 뭐 TFD도 있다하더라,, 근데 TDD가 근본아님? 이라고 생각했고 그 자체에 집중했던 것 같다.
근데 챕터2를 진행하고 나서 지금은 TDD든 TFD든 방법론일 뿐이다 라는 생각이다. 방법론이 뭐지? 방법론이란 어떻게보면 목적을 달성하기 위한 수단이다. 여기서 그 목적은 뭘까, 테스트다. 내가 학습한건 테스트 먼저해야함 아님 테스트 뒤에해야함 이 아니라 테스트 인것이다.

> **테스트의 중요성**은 소프트웨어 개발에서 높은 품질과 신뢰성을 보장하기 위해 필수적입니다. 테스트는 코드와 시스템이 예상대로 동작하는지 확인하고, 버그를 조기에 발견하며, 개발 과정에서 발생할 수 있는 다양한 문제를 방지합니다. 아래는 테스트의 중요성을 설명하는 주요 이유입니다.

지금까지 일해오며 수많은 버그들과 씨름했고 예측못한 예외상황에 골머리를 썩은 적이 한두번이 아니다.
위 글처럼 "테스트는 코드와 시스템이 예상대로 동작하는지 확인" 할 수 있다.
다시말해 테스트 코드로 인해 내 결과물에 믿음이 가고 더 나아가 용기(배포 할 때 손모으고 기도했던 순간이 생각남) 가 생긴다.

그리고 더 나아가 테스트의 중요성을 인지하면 서비스 코드에 대한 설계도 좋은방향으로 흘러갈 가능성이 높다.
```
1. 요구사항을 분석 ( 어떤 기능을 제공해야하는지 )
2. 실패하면 안되는 Input 을 정리 ( 실패 TC 에 대해 정의 )
3. 2번의 TC 를 모두 만족시킬 수 있도록 기능을 구현
4. 기능의 책임을 분석
    - 너무 다양한 TC 가 필요하지 않았는지
    - 너무 많은 책임이 주어져 있지는 않은지 ( 응집도 )
5. 리팩토링
    - 적절한 위상의 책임을 가지고 있도록
    - 충분히 원자적으로 테스트가 가능하도록

```

### 클린 아키텍쳐, 레이어드 아키텍쳐, DDD
나는 거의 레이어드 아키텍쳐를 주로 접했다. (하위참조, 상위참조, DIP 등 고려해본적이 없으니 사용은 애매한듯)
아키텍쳐의에 앞서 DDD에 대해 먼저 말해보면, 이커머스 서비스의 주요 비즈니스 사항은 주문과 결제가 있다. 처음에 내가 작성한 코드는 주문을 하기위해선 사용자 검증, 결제금액은 얼마, 쿠폰의 할인율, 상품 검증, 차감 등이 하나의 주문 서비스에 존재했었다. 딱 봐도 여러 도메인들의 결합과 주문의 무거운 책임이 느껴진다.
결합이 높아지니 다른 도메인들간의 변경이 있을 때마다 주문 도메인은 안전하지 못할 것이다. 이를 인지하지 못하고 굉장히 난잡한 코드가 나왔었는데.. 이는 각 도메인의 책임과 역할을 명확히 구분짓지 못했던 것이다.
극단적으로 말하자면 주문은 주문서만 발행하면 된다. 쿠폰 할인율이 얼마인지, 상품 정보가 어떤지, 결제금액이 얼마인지, 유저 정보는 어떠한지 등등 이 모든 것은 각자 도메인이 책임을 지면 되는 것이다.
각자 도메인의 책임과 역할이 명확해야 각 도메인이 보호받을 수 있을테니

이러한 관점에서 보면, 아키텍처의 설계는 비즈니스 요구사항을 어떻게 효과적으로 반영하고 관리할 것인가를 고민하는 연장선이다. 
클린 & 레이어드 아키텍쳐의 핵심은
- 계층간 하위참조
- DIP 원칙
으로 계층간 상위참조를 막으며 도메인이 중심이 되어 각 계층은 도메인에게 serving하는 형태로 그려진다. 도메인 로직은 다른 계층에 의존하지 않도록 설계되어 있다보니 추후 비즈니스 로직의 변경, 확장 등에도 유연하게 대처 할 수 있다는 생각이 들었다.


